# 2. Определение компонент сильной связности графа. Построение графа Герца

## Компоненты сильной связности
::: info <span class="defn">Опр.</span> **Компонентами сильной связности** орграфа называются максимальные по включению *сильно связанные* подграфы (см. [вопрос 1](./1.md)).
:::
<span class="defn">Опр.</span> **Транспонированным графом** называют граф, в котором все дуги ориентированы противоположно.  
Т.е., дуге $(u,v)$ ставится в соответствие дуга $(v,u)$. 

### Пример поиска компонент сильной связности
```cpp
vector<int> g[maxn], t[maxn];
vector<int> order;
bool used[maxn];
int component[maxn];
int cnt_components = 0;

// топологическая сортировка
void dfs1(int v) {
    used[v] = true;
    for (int u : g[v]) {
        if (!used[u]) 
            dfs1(u);
    order.push_back(v);
}

// маркировка компонент сильной связности
void dfs2(int v) {
    component[v] = cnt_components;
    for (int u : t[v])
        if (component[u] == 0)
            dfs2(u);
}

// в содержательной части main:

// транспонируем граф
for (int v = 0; v < n; v++)
    for (int u : g[v])
        t[u].push_back(v);

// запускаем топологическую сортировку
for (int i = 0; i < n; i++)
    if (!used[i])
        dfs1(i);

// выделяем компоненты
reverse(order.begin(), order.end());
for (int v : order)
    if (component[v] == 0)
        dfs2(v), cnt_components++;
```

Алгоритмическая сложность алгоритма: $O(|V| + |E|)$.

## Граф Герца   
<span class="defn">Опр.</span> **Контур в графе** — это замкнутый путь, в котором его начальная вершина совпадает с конечной.  

::: info <span class="defn">Опр.</span> **Графом Герца** называется бесконтурный орграф, получаемый путем стягивания каждой компоненты сильной связности в одну вершину.
:::

Граф Герца иначе называется графом *конденсации*.

![](../images/ГрафГерца.png)

*Что происходит на картинке?*  
Видите циклы? Это компоненты сильной связности. Мы их именуем как новые вершинки для графа, а потом соединяем точно так же, как те компоненты в исходном графе были связаны.

### Свойства
+ Граф Герца не имеет контура (контур — замкнутый путь через все вершины).
+ Граф Герца не имеет цикла (противоречие: такой цикл будет компонентой сильной связности).

### Построение Графа Герца

После нахождения компонент связности нужно провести некоторые манипуляции со списками смежности, заменив для всех ребер номера вершин номерами их компонент, а затем объединив списки смежности для всех вершин каждой компоненты.
