# 10. Поиск максимального потока. Алгоритм Форда – Фалкерсона.

## Поиск максимального потока.

Условия задачи: рассматривается орграф $G=(V,E)$, $V$ - множество вершин, $E$ - множество ребер. $|V| = n$, $|E| = m$.

Будем считать, что веса $c(e)$ всех дуг не отрицательны. Число $c(e)$ будем называть *пропускной способностью дуги* e.

Предполагаем, что сеть $G = G(V,E,c)$ имеет единственную вершину s с нулевой степенью захода (источник) и единственную вершиной t с нулевой степенью исхода. (сток)

%%Имеется ориентированный неотрицательный взвешенный граф, в котором вес ребра обозначает пропускную способность между вершинами. Нужно найти максимальный поток, который можно пропустить из истока/начала, в который не может ничего входить, в сток/конец, из которого ничего не может выходить.%%



<span class="defn">Опр.</span> Потоком $f$ в сети $G$ (графа) называется функция $f: E -> R$, удовлетворяющая условиям:
1. 0=< $f(e)$ =< $c(e)$ ANY $e \in E$
2. $f(v^+)$ = $f(v^-)$
ANY $v \in V$, $v \neq s$, $v \neq t$
%%Поток это число которое проходит через какое-то ребра выходящего из какой-либо точки, при этом удовлетворяющий условиям: 
1. Поток не может быть меньше нуля и он не может превышать пропускную способность ребра
2. Сколько потока вошло в точку, столько же потока должно выйти суммарно из всех рёбер точки.%%
<span class="defn">Опр.</span> Величина потока - число $||f|| = f(s^+)$

%% Величина потока это число которое мы ставим в исток/начало графа%%
<span class="defn">Опр.</span> Максимальный поток - поток $f$ для которого, выполняется неравенство: $||f|| =< ||f*||$, где $f*$ любой другой поток.

%%Максимальный поток это тот поток, величина которого наибольшая из всех возможных%%

Постановка задачи: Нужно найти максимальный поток.
%%Если кому-то нужны здесь комментарии, то он долбоёб похуже меня%%
Данную задачу невозможно решить полным перебором. (Никто не говорил что поток должен быть целым.)

Теорема: В каждой сети (графе) существует максимальный поток.

%%Поток(это функция, если мозги сохнут) штука непрерывная, но так как она ограничена рёбрами и графом в принципе, то соответственно есть максимум и минимум.%%

<span class="defn">Опр.</span> Разрез - минимальное множество дуг, удаление которых из орграфа приводит к разрушению всех $(v,w)$ - путей.

%%Разрез - минимальное группа рёбер, удалив которые путь из одной точки в другую невозможен, причём точки могут быть и не близлежащие.%%

<span class="defn">Опр.</span> Разрез между истоком и стоком $(V_s,V_t)$ в сети $G$ называется пара множеств $V_s, V_t$ удовлетворяющая условиям: 
1. $s \in V_s$, $t \in V_t$
2. $V_s U V_t = V$
3. $V_s$ Пересечение $V_t = 0$

%%Это два множества точек удовлетворяющее условиям:
1. Исток в одном множестве, сток в другом.
2. Их объединение равно всему графу
3. Их пересечение должно быть нихуя.%%

Теорема: Для любого потока $f$ и любого разреза $(V_s, V_t)$ справедливо равенство
$||f|| = f(V_s ->V_t) - f(V_t -> V_s)$

%%Суть в том что для любого потока и любого разреза между истоком и стоком должно выполняться равенство Величина потока равна (Сумме всех пропускных способностей рёбер ведущих из истока в сток) минус (Сумма всех пропускных способностей рёбер ведущих из стока в исток)%%

<span class="defn">Опр.</span> Число $c(V_s, V_t) =$ Сумме всех пропускных способностей рёбер из $V_s$ в $V_t$ 
%%вроде понятно%%

Разрез называется минимальным если для любого разреза $(V^*_s, V^*_t)$ справедливо $с(V_s, V_t)=<c(V^*_s, V^*_t)$

Теорема: Если для потока $f^*$ и некоторого $(V^*_s, V^*_t)$ выполняется равенство $||f^*|| = c(V^*_s, V^*_t)$, то поток $f^*$ максимален, а разрез $(V^*_s, V^*_t)$ минимален.

%%Вроде пока все.%%

Цепи я думаю понятно что. Если нет, то ты долбон.

# Алгоритм Форда – Фалкерсона

Сам Алгоритм:
- В начальный момент времени поток, который мы хотим провести через нашу сеть, должен быть равен нулю. _Остаточная сеть_ совпадает с исходной сетью.
    
- Находим **любой** путь из _истока_ в _сток_ в _остаточной сети._ Если путь не находим, утверждается, что поток является максимальным.
    
- Пускаем через найденный путь поток равный минимальному весу ребра, которое входит в множество рёбер найденного пути.
    
- Из веса рёбер на этом пути высчитываем размер потока, который мы пустили.
    
- А к весу обратных рёбер (будем считать, что они существуют в _остаточной сети_ и равны 0) прибавляем размер потока. Другими словами, на предыдущем шаге мы отправили некоторое количество потока из текущей вершины в следующую**,** а теперь при желании можем вернуть это же количество потока обратно в текущую.
    
- Возвращаемся обратно к нахождению пути в _остаточной сети_ после модификации.

Теорема: Сложность алгоритма составляет $O(m*M)$ где $m$ - количество рёбер, а $M$ - величина максимального потока

Теорема: Если на каждой итерации алгоритма Форда-Фалкерсона выбирать кратчайшую по числу дуг $f$-дополняющую $(s,t)$ цепь, то построение максимального потока требует не более чем $(m(n+2))/2$ итераций.
