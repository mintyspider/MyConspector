# 16. Z-функция, построение, использование.

## Z-функция

::: info <span class="defn">Опр.</span> **Z-функция** (англ. Z-function) от строки S и позиции x — это длина максимального префикса подстроки, начинающейся с позиции x
 в строке S , который одновременно является и префиксом всей строки S. Более формально, $Z[i](s)=maxk∣s[i…i+k]=s[0…k]$. Значение Z-функции от первой позиции не определено, поэтому его обычно приравнивают к нулю или к длине строки.
:::

![](../images/z.png)

## Построение Z-функции

----

Задача:
Необходимо построить z-функцию.

----

### Описание алгоритма

Простая реализация за $O(n^2)$, где n — длина строки. Для каждой позиции i перебираем для неё ответ, начиная с нуля, пока не обнаружим несовпадение или не дойдем до конца строки.

### Реализация

Псевдокод
```c
int[] zFunction(s : string):
   int[] zf = int[n]
   for i = 1 to n − 1
     while i + zf[i] < n and s[zf[i]] == s[i + zf[i]]
       zf[i]++
   return zf
```

## Использование - поиск подстроки в строке

### Описание алгоритма

n — длина текста. m — длина образца.

Образуем строку s = pattern + # + text, где # — символ, не встречающийся ни в text, ни в pattern. Вычисляем Z-функцию от этой строки. В полученном массиве, в позициях в которых значение Z-функции равно |pattern|, по определению начинается подстрока, совпадающая с pattern.

### Реализация

Псевдокод
```c
int substringSearch(text : string, pattern : string):
   int[] zf = zFunction(pattern + '#' + text)
   for i = m + 1 to n + 1
     if zf[i] == m 
       return i
```